<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <title>XAZAI - AÃ§ai Bar & Smoothies</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="theme-color" content="#1a0a3e">
    <link rel="stylesheet" href="styles.css?v=20260223g">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-left">
            <div class="logo-small">
                <img src="images/logo-xazai.png" alt="XAZAI - AÃ§ai Bar & Smoothies" class="logo-img-nav">
            </div>
        </div>
        <div class="nav-center">
            <div class="category-tabs" id="category-tabs">
                <button class="tab active" data-category="inicio"><i class="fas fa-home"></i> Inicio</button>
                <button class="tab" data-category="bowls"><i class="fas fa-bowl-food"></i> Bowls</button>
                <button class="tab" data-category="smoothies"><i class="fas fa-blender"></i> Smoothies</button>
                <button class="tab" data-category="jugos"><i class="fas fa-glass-water"></i> Jugos</button>
                <button class="tab" data-category="shots"><i class="fas fa-fire-flame-curved"></i> Shots</button>
                <button class="tab" data-category="cafe"><i class="fas fa-mug-hot"></i> CafÃ©</button>
                <button class="tab" data-category="bebidas"><i class="fas fa-bottle-water"></i> Bebidas</button>
                <!-- Mis Pedidos moved to user dropdown -->
                <button class="tab tab-highlight" data-category="arma-tu-bowl"><i class="fas fa-wand-magic-sparkles"></i> Arma tu Bowl</button>
            </div>
        </div>
        <div class="nav-right">
            <div class="store-status" id="store-status">
                <span class="status-dot"></span>
                <span class="status-text" id="status-text">Cargando...</span>
            </div>
            <button class="cart-btn" id="cart-btn">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count" id="cart-count">0</span>
            </button>
            <div class="user-menu">
                <button class="user-btn" id="user-btn">
                    <i class="fas fa-user-circle"></i>
                    <span id="user-name">Mi Cuenta</span>
                </button>
                <div class="user-dropdown hidden" id="user-dropdown">
                    <button id="admin-panel-btn" class="dropdown-item hidden">
                        <i class="fas fa-cog"></i> Panel Admin
                    </button>
                    <button id="tab-mis-pedidos" class="dropdown-item hidden">
                        <i class="fas fa-receipt"></i> Mis Pedidos
                    </button>
                    <button id="login-trigger-btn" class="dropdown-item">
                        <i class="fas fa-sign-in-alt"></i> Iniciar SesiÃ³n
                    </button>
                    <button id="logout-btn" class="dropdown-item hidden">
                        <i class="fas fa-sign-out-alt"></i> Cerrar SesiÃ³n
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- MENU SECTION -->
    <section class="menu-section" id="menu-section">
        <div class="products-list" id="products-grid"></div>
    </section>

    <!-- BUILD YOUR BOWL SECTION -->
    <section class="build-bowl-section hidden" id="build-bowl-section">
        <div class="section-header">
            <h2>Arma tu Bowl</h2>
            <p>Personaliza tu bowl perfecto paso a paso</p>
        </div>
        <div class="build-steps">
            <div class="build-step">
                <h3><span class="step-number">1</span> Elige tu base</h3>
                <div class="build-options" id="base-options"></div>
            </div>
            <div class="build-step">
                <h3><span class="step-number">2</span> Agrega textura</h3>
                <div class="build-options" id="protein-options"></div>
            </div>
            <div class="build-step">
                <h3><span class="step-number">3</span> Elige tus toppings (hasta 4)</h3>
                <div class="build-options" id="topping-options"></div>
            </div>
            <div class="build-step">
                <h3><span class="step-number">4</span> Elige tu drizzle</h3>
                <div class="build-options" id="dressing-options"></div>
            </div>
            <div class="build-summary">
                <h3>Tu Bowl Personalizado</h3>
                <div id="build-summary-content">
                    <p class="empty-build">Selecciona tus ingredientes para comenzar</p>
                </div>
                <div class="build-total">
                    <span>Total:</span>
                    <span id="build-total-price">$0.00</span>
                </div>
                <button class="btn-add-build" id="btn-add-build" disabled>
                    <i class="fas fa-cart-plus"></i> Agregar al Carrito
                </button>
            </div>
        </div>
    </section>

    <!-- MIS PEDIDOS SECTION - Customer Order Tracking -->
    <section class="mis-pedidos-section hidden" id="mis-pedidos-section">
        <div class="section-header">
            <h2><i class="fas fa-receipt"></i> Mis Pedidos</h2>
            <p>Seguimiento en tiempo real de tus pedidos</p>
        </div>
        <div id="mis-pedidos-active">
            <h3 class="mp-subtitle"><i class="fas fa-clock"></i> Pedidos Activos</h3>
            <div id="mis-pedidos-active-list">
                <p class="mp-empty"><i class="fas fa-inbox"></i> No tienes pedidos activos</p>
            </div>
        </div>
        <div id="mis-pedidos-history">
            <h3 class="mp-subtitle"><i class="fas fa-history"></i> Historial</h3>
            <div id="mis-pedidos-history-list">
                <p class="mp-empty">No tienes pedidos anteriores</p>
            </div>
        </div>
    </section>

    <!-- FLOATING CHECKOUT BAR -->
    <div class="floating-checkout hidden" id="floating-checkout">
        <div class="floating-checkout-info">
            <span class="floating-items" id="floating-items">0 items</span>
            <span class="floating-total" id="floating-total">$0.00</span>
        </div>
        <button class="floating-checkout-btn" id="floating-checkout-btn">
            <span>Finalizar Pedido</span>
            <i class="fas fa-arrow-right"></i>
        </button>
    </div>

    <!-- CART SIDEBAR -->
    <div class="cart-overlay hidden" id="cart-overlay"></div>
    <div class="cart-sidebar hidden" id="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-cart"></i> Tu Carrito</h3>
            <button class="cart-close" id="cart-close"><i class="fas fa-times"></i></button>
        </div>
        <div class="cart-items" id="cart-items">
            <div class="cart-empty">
                <i class="fas fa-shopping-basket"></i>
                <p>Tu carrito estÃ¡ vacÃ­o</p>
            </div>
        </div>
        <div class="cart-footer" id="cart-footer">
            <div class="cart-subtotal hidden">
                <span>Subtotal</span>
                <span id="cart-subtotal">$0.00</span>
            </div>
            <div class="cart-total">
                <span>Total (sin envÃ­o)</span>
                <span id="cart-total">$0.00</span>
            </div>
            <div class="cart-delivery-note">
                <i class="fas fa-motorcycle"></i> El costo de envÃ­o se calcula al finalizar segÃºn tu ubicaciÃ³n
            </div>
            <button class="btn-checkout" id="btn-checkout">
                <i class="fas fa-credit-card"></i> Finalizar Pedido
            </button>
        </div>
    </div>

    <!-- LOGIN MODAL (for checkout) -->
    <div class="modal-overlay hidden" id="login-modal">
        <div class="login-modal-content">
            <button class="modal-close" id="login-modal-close"><i class="fas fa-times"></i></button>
            <div class="login-logo">
                <img src="images/logo-xazai.png" alt="XAZAI" class="logo-img-modal">
            </div>
            <h2>Ingresa tu nÃºmero para ordenar</h2>
            <p class="login-subtitle">O continÃºa como invitado</p>
            <form id="login-form">
                <div class="phone-input-group">
                    <div class="country-select-wrapper">
                        <select id="country-code" class="country-code-select">
                            <option value="+507" selected>ðŸ‡µðŸ‡¦ +507</option>
                            <option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
                            <option value="+52">ðŸ‡²ðŸ‡½ +52</option>
                            <option value="+57">ðŸ‡¨ðŸ‡´ +57</option>
                            <option value="+506">ðŸ‡¨ðŸ‡· +506</option>
                            <option value="+503">ðŸ‡¸ðŸ‡» +503</option>
                            <option value="+502">ðŸ‡¬ðŸ‡¹ +502</option>
                            <option value="+504">ðŸ‡­ðŸ‡³ +504</option>
                            <option value="+505">ðŸ‡³ðŸ‡® +505</option>
                            <option value="+593">ðŸ‡ªðŸ‡¨ +593</option>
                            <option value="+51">ðŸ‡µðŸ‡ª +51</option>
                            <option value="+56">ðŸ‡¨ðŸ‡± +56</option>
                            <option value="+54">ðŸ‡¦ðŸ‡· +54</option>
                            <option value="+55">ðŸ‡§ðŸ‡· +55</option>
                            <option value="+58">ðŸ‡»ðŸ‡ª +58</option>
                            <option value="+34">ðŸ‡ªðŸ‡¸ +34</option>
                        </select>
                    </div>
                    <div class="phone-number-wrapper">
                        <i class="fas fa-phone"></i>
                        <input type="tel" id="login-phone" placeholder="NÃºmero de telÃ©fono" inputmode="numeric" pattern="[0-9]*" autocomplete="tel">
                    </div>
                </div>
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="login-name" placeholder="Tu nombre (opcional)">
                </div>
                <button type="submit" class="btn-login"><i class="fas fa-paper-plane"></i> Continuar</button>
                <button type="button" class="btn-guest" id="btn-guest">Continuar como invitado</button>
            </form>
            <p id="login-error" class="login-error"></p>
        </div>
    </div>

    <!-- ADMIN DASHBOARD (Full Screen) -->
    <div id="admin-dashboard" class="hidden">
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <img src="images/logo-xazai.png" alt="XAZAI" class="admin-logo-img">
                <span class="admin-logo-text">Admin</span>
            </div>
            <nav class="admin-nav">
                <button class="admin-nav-btn active" data-section="orders">
                    <i class="fas fa-receipt"></i>
                    <span>Pedidos</span>
                    <span class="admin-badge hidden" id="orders-badge">0</span>
                </button>
                <button class="admin-nav-btn" data-section="pos">
                    <i class="fas fa-cash-register"></i>
                    <span>Caja / POS</span>
                </button>
                <button class="admin-nav-btn" data-section="inventory">
                    <i class="fas fa-boxes-stacked"></i>
                    <span>Inventario</span>
                </button>
                <button class="admin-nav-btn" data-section="menu">
                    <i class="fas fa-utensils"></i>
                    <span>MenÃº</span>
                </button>
                <button class="admin-nav-btn" data-section="expenses">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Gastos</span>
                </button>
                <button class="admin-nav-btn" data-section="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </button>
                <button class="admin-nav-btn" data-section="asistencia">
                    <i class="fas fa-fingerprint"></i>
                    <span>Asistencia</span>
                </button>
                <button class="admin-nav-btn" data-section="comportamiento">
                    <i class="fas fa-brain"></i>
                    <span>Comportamiento</span>
                </button>
                <button class="admin-nav-btn" data-section="facturacion">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>FacturaciÃ³n</span>
                </button>
                <button class="admin-nav-btn" data-section="mesas">
                    <i class="fas fa-chair"></i>
                    <span>Mesas</span>
                </button>
                <button class="admin-nav-btn" data-section="rrhh">
                    <i class="fas fa-id-badge"></i>
                    <span>RRHH</span>
                </button>
                <button class="admin-nav-btn" data-section="usuarios">
                    <i class="fas fa-users"></i>
                    <span>Usuarios</span>
                </button>
            </nav>
            <button class="admin-logout-btn" id="admin-logout">
                <i class="fas fa-sign-out-alt"></i>
                <span>Cerrar SesiÃ³n</span>
            </button>
        </aside>
        <main class="admin-main">
            <!-- PEDIDOS Section -->
            <section id="admin-sec-orders" class="admin-section">
                <div class="admin-section-header">
                    <h2><i class="fas fa-receipt"></i> Pedidos en Tiempo Real</h2>
                    <div class="store-toggle" id="store-toggle">
                        <span class="store-toggle-label">Estado del negocio:</span>
                        <button class="store-toggle-btn active" data-store-status="auto">
                            <i class="fas fa-clock"></i> AutomÃ¡tico
                        </button>
                        <button class="store-toggle-btn" data-store-status="abierto">
                            <i class="fas fa-door-open"></i> Abierto
                        </button>
                        <button class="store-toggle-btn" data-store-status="cerrado">
                            <i class="fas fa-door-closed"></i> Cerrado
                        </button>
                        <button class="store-toggle-btn" data-store-status="alta_demanda">
                            <i class="fas fa-fire"></i> Alta Demanda
                        </button>
                    </div>
                    <div class="orders-filter" id="admin-orders-filter">
                        <button class="filter-btn active" data-status="all">Todos</button>
                        <button class="filter-btn" data-status="pendiente">Pendientes</button>
                        <button class="filter-btn" data-status="preparando">Preparando</button>
                        <button class="filter-btn" data-status="listo">Listos</button>
                        <button class="filter-btn" data-status="en_camino">En Camino</button>
                        <button class="filter-btn" data-status="entregado">Entregados</button>
                        <button class="filter-btn" data-status="cancelado">Cancelados</button>
                    </div>
                </div>
                <div class="admin-orders-grid" id="admin-orders-list">
                    <p class="no-orders">No hay pedidos aÃºn</p>
                </div>
            </section>

            <!-- POS / CAJA Section -->
            <section id="admin-sec-pos" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-cash-register"></i> Caja / POS</h2>
                </div>
                <div class="pos-layout">
                    <div class="pos-products">
                        <div class="pos-categories" id="pos-categories">
                            <button class="pos-cat-btn active" data-cat="all">Todos</button>
                        </div>
                        <div class="pos-products-grid" id="pos-products-grid"></div>
                    </div>
                    <div class="pos-invoice">
                        <div class="pos-invoice-header">
                            <h3><i class="fas fa-file-invoice-dollar"></i> Factura</h3>
                            <button class="pos-clear-btn" id="pos-clear"><i class="fas fa-trash"></i> Limpiar</button>
                        </div>
                        <div class="pos-invoice-items" id="pos-invoice-items">
                            <p class="pos-empty">Agrega productos a la factura</p>
                        </div>
                        <div class="pos-invoice-totals">
                            <div class="pos-total-line"><span>Subtotal</span><span id="pos-subtotal">$0.00</span></div>
                            <div class="pos-discount-section">
                                <span class="pos-discount-label">Descuento</span>
                                <div class="pos-discount-options">
                                    <button class="pos-discount-btn active" data-discount="0">Sin</button>
                                    <button class="pos-discount-btn" data-discount="15">15% <small>Jubilado</small></button>
                                    <button class="pos-discount-btn" data-discount="10">10%</button>
                                    <button class="pos-discount-btn" data-discount="custom">Otro</button>
                                </div>
                                <div class="pos-discount-custom hidden" id="pos-discount-custom">
                                    <div class="pos-cash-input-wrap"><span>%</span><input type="number" id="pos-discount-amount" placeholder="0" min="0" max="100" step="1"></div>
                                </div>
                            </div>
                            <div class="pos-total-line pos-discount-line hidden" id="pos-discount-display">
                                <span>Descuento (<span id="pos-discount-pct">0</span>%)</span>
                                <span id="pos-discount-value" class="pos-discount-savings">-$0.00</span>
                            </div>
                            <div class="pos-tip-section">
                                <span class="pos-tip-label">Propina</span>
                                <div class="pos-tip-type-row">
                                    <button class="pos-tip-type-btn active" data-pos-tip-type="fixed">$ Fijo</button>
                                    <button class="pos-tip-type-btn" data-pos-tip-type="percent">% Pct</button>
                                </div>
                                <div class="pos-tip-options" id="pos-tip-opts-fixed">
                                    <button class="pos-tip-btn active" data-tip="0">Sin</button>
                                    <button class="pos-tip-btn" data-tip="1">$1</button>
                                    <button class="pos-tip-btn" data-tip="2">$2</button>
                                    <button class="pos-tip-btn" data-tip="5">$5</button>
                                    <button class="pos-tip-btn" data-tip="custom">Otro</button>
                                </div>
                                <div class="pos-tip-options hidden" id="pos-tip-opts-percent">
                                    <button class="pos-tip-pct-btn" data-pct="10">10%</button>
                                    <button class="pos-tip-pct-btn" data-pct="15">15%</button>
                                    <button class="pos-tip-pct-btn" data-pct="18">18%</button>
                                    <button class="pos-tip-pct-btn" data-pct="20">20%</button>
                                </div>
                                <div class="pos-tip-custom hidden" id="pos-tip-custom">
                                    <div class="pos-cash-input-wrap"><span>$</span><input type="number" id="pos-tip-amount" placeholder="0.00" min="0" step="0.01"></div>
                                </div>
                            </div>
                            <div class="pos-delivery-section">
                                <span class="pos-delivery-label"><i class="fas fa-motorcycle"></i> Delivery</span>
                                <div class="pos-delivery-toggle">
                                    <label class="toggle-switch"><input type="checkbox" id="pos-delivery-toggle"><span class="toggle-slider"></span></label>
                                </div>
                            </div>
                            <div class="pos-delivery-fields hidden" id="pos-delivery-fields">
                                <div class="pos-cash-input-wrap"><span>$</span><input type="number" id="pos-delivery-amount" placeholder="0.00" min="0" step="0.50"></div>
                                <input type="text" id="pos-delivery-note" placeholder="DirecciÃ³n o referencia..." class="pos-ref-input" maxlength="120">
                            </div>
                            <div class="pos-total-line pos-delivery-line hidden" id="pos-delivery-display">
                                <span><i class="fas fa-motorcycle"></i> Delivery</span>
                                <span id="pos-delivery-value">$0.00</span>
                            </div>
                            <div class="pos-total-line pos-total-main"><span>Total</span><span id="pos-total">$0.00</span></div>
                        </div>
                        <div class="pos-payment-method">
                            <h4>MÃ©todo de Pago</h4>
                            <div class="pos-methods">
                                <button class="pos-method-btn active" data-method="efectivo"><i class="fas fa-money-bill-wave"></i> Efectivo</button>
                                <button class="pos-method-btn" data-method="yappy"><i class="fas fa-mobile-alt"></i> Yappy</button>
                                <button class="pos-method-btn" data-method="tarjeta"><i class="fas fa-credit-card"></i> Tarjeta</button>
                                <button class="pos-method-btn" data-method="ach"><i class="fas fa-university"></i> ACH</button>
                            </div>
                            <div class="pos-cash-change" id="pos-cash-change">
                                <div class="pos-cash-row">
                                    <label>Recibido:</label>
                                    <div class="pos-cash-input-wrap">
                                        <span>$</span>
                                        <input type="number" id="pos-cash-received" placeholder="0.00" min="0" step="0.01">
                                    </div>
                                </div>
                                <div class="pos-cash-row pos-change-row">
                                    <label>Cambio:</label>
                                    <span id="pos-change-amount" class="pos-change-value">$0.00</span>
                                </div>
                            </div>
                            <!-- Payment detail fields per method -->
                            <div class="pos-payment-details hidden" id="pos-payment-details-tarjeta">
                                <div class="pos-cash-row">
                                    <label><i class="fas fa-credit-card"></i> Ãšltimos 4 dÃ­gitos / Ref:</label>
                                    <input type="text" id="pos-tarjeta-ref" placeholder="1234 o referencia" maxlength="30" class="pos-ref-input">
                                </div>
                            </div>
                            <div class="pos-payment-details hidden" id="pos-payment-details-ach">
                                <div class="pos-cash-row">
                                    <label><i class="fas fa-university"></i> No. Referencia ACH:</label>
                                    <input type="text" id="pos-ach-ref" placeholder="Referencia de transferencia" maxlength="40" class="pos-ref-input">
                                </div>
                            </div>
                            <div class="pos-payment-details hidden" id="pos-payment-details-yappy">
                                <div class="pos-cash-row">
                                    <label><i class="fas fa-mobile-alt"></i> Referencia Yappy:</label>
                                    <input type="text" id="pos-yappy-ref" placeholder="Ref. de transacciÃ³n Yappy" maxlength="40" class="pos-ref-input">
                                </div>
                            </div>
                        </div>
                        <!-- Customer search for POS -->
                        <div class="pos-customer-search">
                            <h4><i class="fas fa-user-tag"></i> Cliente (Opcional)</h4>
                            <div class="pos-customer-input-wrap">
                                <i class="fas fa-phone"></i>
                                <input type="tel" id="pos-customer-phone" placeholder="Buscar por telÃ©fono..." inputmode="numeric">
                                <button class="pos-customer-search-btn" id="pos-customer-search-btn"><i class="fas fa-search"></i></button>
                            </div>
                            <div class="pos-customer-result hidden" id="pos-customer-result">
                                <i class="fas fa-user-check"></i>
                                <span id="pos-customer-name-display"></span>
                                <button class="pos-customer-clear" id="pos-customer-clear"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <button class="pos-charge-btn" id="pos-charge-btn" disabled>
                            <i class="fas fa-check-circle"></i> Cobrar
                        </button>
                        <div class="pos-sales-today">
                            <h4><i class="fas fa-chart-line"></i> Ventas de Hoy</h4>
                            <div class="pos-sales-summary" id="pos-sales-summary">
                                <div class="pos-sale-stat">
                                    <span class="pos-sale-label">Ventas</span>
                                    <span class="pos-sale-value" id="pos-sales-count">0</span>
                                </div>
                                <div class="pos-sale-stat">
                                    <span class="pos-sale-label">Total</span>
                                    <span class="pos-sale-value" id="pos-sales-total">$0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- INVENTARIO Section -->
            <section id="admin-sec-inventory" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-boxes-stacked"></i> Control de Inventario</h2>
                    <p class="admin-section-subtitle">Controla productos, ingredientes y cantidades</p>
                </div>
                <div class="inv-tabs">
                    <button class="inv-tab-btn active" data-inv-tab="productos">Productos</button>
                    <button class="inv-tab-btn" data-inv-tab="ingredientes">Ingredientes</button>
                </div>
                <div id="inv-tab-productos" class="inv-tab-content">
                    <div class="inv-size-filter" id="inv-size-filter">
                        <button class="inv-size-btn active" data-size-filter="all">Todos</button>
                        <button class="inv-size-btn" data-size-filter="medio"><i class="fas fa-compress-alt"></i> Solo M</button>
                        <button class="inv-size-btn" data-size-filter="both"><i class="fas fa-arrows-alt-h"></i> M + G</button>
                        <button class="inv-size-btn" data-size-filter="grande"><i class="fas fa-expand-alt"></i> Solo G</button>
                    </div>
                    <div class="inventory-list" id="inventory-list"></div>
                </div>
                <div id="inv-tab-ingredientes" class="inv-tab-content hidden">
                    <div class="inventory-list" id="ingredients-list"></div>
                </div>
            </section>

            <!-- MENU ADMIN Section -->
            <section id="admin-sec-menu" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-utensils"></i> GestiÃ³n de MenÃº</h2>
                    <p class="admin-section-subtitle">Crea, edita y administra todos los productos del menÃº</p>
                </div>
                <div class="menu-admin-toolbar">
                    <div class="menu-filters-wrapper">
                        <button class="menu-filters-arrow menu-filters-arrow-left" id="menu-filters-left" aria-label="Anterior"><i class="fas fa-chevron-left"></i></button>
                        <div class="menu-admin-filters" id="menu-admin-filters">
                            <button class="menu-filter-btn active" data-menu-cat="all">Todos</button>
                        </div>
                        <button class="menu-filters-arrow menu-filters-arrow-right" id="menu-filters-right" aria-label="Siguiente"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <button class="menu-add-btn" id="menu-add-btn"><i class="fas fa-plus"></i> Nuevo Producto</button>
                </div>
                <div class="menu-admin-grid" id="menu-admin-grid">
                    <p class="no-orders">Cargando productos...</p>
                </div>

                <!-- Menu Item Form Modal -->
                <div class="menu-form-overlay hidden" id="menu-form-overlay">
                    <div class="menu-form-content">
                        <button class="modal-close" id="menu-form-close"><i class="fas fa-times"></i></button>
                        <h3 id="menu-form-title"><i class="fas fa-plus-circle"></i> Nuevo Producto</h3>
                        <div class="menu-form-body">
                            <div class="menu-form-grid">
                                <div class="menu-form-field menu-form-img-field">
                                    <label>Imagen del Producto</label>
                                    <div class="menu-img-upload" id="menu-img-upload">
                                        <input type="file" id="menu-img-input" accept="image/*" style="display:none">
                                        <div class="menu-img-placeholder" id="menu-img-placeholder">
                                            <i class="fas fa-camera"></i>
                                            <span>Subir imagen</span>
                                        </div>
                                        <img id="menu-img-preview" class="menu-img-preview" style="display:none" alt="Preview">
                                    </div>
                                </div>
                                <div class="menu-form-field">
                                    <label>Nombre <span class="req">*</span></label>
                                    <input type="text" id="menu-item-name" placeholder="Ej: AÃ§aÃ­ Power Bowl">
                                </div>
                                <div class="menu-form-field">
                                    <label>CategorÃ­a <span class="req">*</span></label>
                                    <select id="menu-item-category">
                                        <option value="bowls">Bowls</option>
                                        <option value="smoothies">Smoothies</option>
                                        <option value="jugos">Jugos</option>
                                        <option value="shots">Shots</option>
                                        <option value="cafe">CafÃ©</option>
                                        <option value="bebidas">Bebidas</option>
                                    </select>
                                </div>
                                <div class="menu-form-field">
                                    <label>Tagline</label>
                                    <input type="text" id="menu-item-tagline" placeholder="Ej: El favorito de la casa">
                                </div>
                                <div class="menu-form-field menu-form-full">
                                    <label>DescripciÃ³n</label>
                                    <textarea id="menu-item-description" rows="3" placeholder="DescripciÃ³n del producto..."></textarea>
                                </div>
                                <div class="menu-form-field">
                                    <label>Emoji</label>
                                    <input type="text" id="menu-item-emoji" placeholder="ðŸ’œ" maxlength="4">
                                </div>
                                <div class="menu-form-field">
                                    <label>Badge</label>
                                    <input type="text" id="menu-item-badge" placeholder="Ej: ClÃ¡sico, Favorito">
                                </div>
                                <div class="menu-form-field">
                                    <label>Precio ($) <span class="req">*</span></label>
                                    <input type="number" id="menu-item-price" placeholder="0.00" min="0" step="0.01">
                                </div>
                                <div class="menu-form-field">
                                    <label>Precio Grande ($)</label>
                                    <input type="number" id="menu-item-price-grande" placeholder="Dejar vacÃ­o si solo un tamaÃ±o" min="0" step="0.01">
                                </div>
                                <div class="menu-form-field menu-form-toggle-field">
                                    <label>Solo un tamaÃ±o (Grande)</label>
                                    <label class="toggle-switch"><input type="checkbox" id="menu-item-only-grande" checked><span class="toggle-slider"></span></label>
                                </div>
                                <div class="menu-form-field menu-form-full">
                                    <label>Ingredientes</label>
                                    <div class="menu-tags-container" id="menu-ingredients-tags"></div>
                                    <div class="menu-tag-input-row">
                                        <input type="text" id="menu-ingredient-input" placeholder="Agregar ingrediente...">
                                        <button class="menu-tag-add-btn" id="menu-ingredient-add"><i class="fas fa-plus"></i></button>
                                    </div>
                                </div>
                                <div class="menu-form-field menu-form-full">
                                    <label>Toppings</label>
                                    <div class="menu-tags-container" id="menu-toppings-tags"></div>
                                    <div class="menu-tag-input-row">
                                        <input type="text" id="menu-topping-input" placeholder="Agregar topping...">
                                        <button class="menu-tag-add-btn" id="menu-topping-add"><i class="fas fa-plus"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="menu-form-actions">
                                <button class="menu-form-cancel" id="menu-form-cancel">Cancelar</button>
                                <button class="menu-form-save" id="menu-form-save"><i class="fas fa-save"></i> Guardar Producto</button>
                                <button class="menu-form-delete hidden" id="menu-form-delete"><i class="fas fa-trash"></i> Eliminar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- GASTOS Section -->
            <section id="admin-sec-expenses" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-file-invoice-dollar"></i> Registro de Gastos</h2>
                    <p class="admin-section-subtitle">Lleva el control de facturas y gastos del negocio</p>
                </div>
                <div class="expense-form-card">
                    <h3><i class="fas fa-plus-circle"></i> Nuevo Gasto</h3>
                    <div class="expense-form-grid">
                        <div class="expense-field">
                            <label>Foto de Factura</label>
                            <div class="expense-img-upload" id="expense-img-upload">
                                <input type="file" id="expense-file-input" accept="image/*" capture="environment" style="display:none">
                                <div class="expense-img-placeholder" id="expense-img-placeholder">
                                    <i class="fas fa-camera"></i>
                                    <span>Tomar foto o subir imagen</span>
                                </div>
                                <img id="expense-img-preview" class="expense-img-preview" style="display:none" alt="Preview">
                            </div>
                        </div>
                        <div class="expense-field">
                            <label>DescripciÃ³n</label>
                            <input type="text" id="expense-description" placeholder="Ej: Compra de frutas">
                        </div>
                        <div class="expense-field">
                            <label>CategorÃ­a</label>
                            <select id="expense-category">
                                <option value="proveedor">Proveedor</option>
                                <option value="servicios">Servicios</option>
                                <option value="mantenimiento">Mantenimiento</option>
                                <option value="inventario">Inventario</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                        <div class="expense-field">
                            <label>Monto ($)</label>
                            <input type="number" id="expense-amount" placeholder="0.00" min="0" step="0.01">
                        </div>
                        <div class="expense-field">
                            <label>Fecha</label>
                            <input type="date" id="expense-date">
                        </div>
                    </div>
                    <button class="expense-save-btn" id="expense-save-btn">
                        <i class="fas fa-save"></i> Guardar Gasto
                    </button>
                </div>
                <div id="expenses-list"></div>
            </section>

            <!-- DASHBOARD Section -->
            <section id="admin-sec-dashboard" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-chart-line"></i> Dashboard Financiero</h2>
                    <p class="admin-section-subtitle">Vista resumida de ventas, gastos y ganancias</p>
                </div>
                <div class="dash-date-controls">
                    <div class="dash-range-tabs">
                        <button class="dash-range-btn active" data-range="day">Hoy</button>
                        <button class="dash-range-btn" data-range="week">Semana</button>
                        <button class="dash-range-btn" data-range="month">Mes</button>
                        <button class="dash-range-btn" data-range="custom">Rango</button>
                    </div>
                    <div class="dash-date-inputs">
                        <div class="dash-nav-arrows">
                            <button id="dash-prev"><i class="fas fa-chevron-left"></i></button>
                            <span id="dash-current-label">Hoy</span>
                            <button id="dash-next"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="dash-custom-range hidden" id="dash-custom-range">
                            <input type="date" id="dash-date-from">
                            <span>â€”</span>
                            <input type="date" id="dash-date-to">
                            <button class="dash-apply-btn" id="dash-apply-range"><i class="fas fa-search"></i></button>
                        </div>
                    </div>
                </div>
                <div class="dash-summary-grid" id="dash-summary"></div>
                <div class="dash-grid-2col">
                    <div class="dash-panel" id="dash-payments">
                        <h3><i class="fas fa-wallet"></i> Desglose por MÃ©todo (Cierre)</h3>
                        <div id="dash-payments-content"></div>
                    </div>
                    <div class="dash-panel" id="dash-top-products">
                        <h3><i class="fas fa-trophy"></i> Top 5 Productos</h3>
                        <div id="dash-top-content"></div>
                    </div>
                </div>
                <div class="dash-panel" id="dash-recent">
                    <h3><i class="fas fa-clock"></i> Actividad Reciente</h3>
                    <div id="dash-recent-content"></div>
                </div>
            </section>

            <!-- RRHH Section -->
            <section id="admin-sec-rrhh" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-id-badge"></i> Recursos Humanos</h2>
                    <p class="admin-section-subtitle">Gestiona roles, colaboradores y reportes</p>
                </div>

                <!-- RRHH Internal Tabs -->
                <div class="rrhh-tabs">
                    <button class="rrhh-tab-btn active" data-rrhh-tab="roles"><i class="fas fa-user-shield"></i> Roles</button>
                    <button class="rrhh-tab-btn" data-rrhh-tab="colaboradores"><i class="fas fa-users"></i> Colaboradores</button>
                    <button class="rrhh-tab-btn" data-rrhh-tab="reportes"><i class="fas fa-chart-bar"></i> Reportes</button>
                </div>

                <!-- TAB: Roles -->
                <div id="rrhh-tab-roles" class="rrhh-tab-content">
                    <div class="rrhh-card-form">
                        <h3><i class="fas fa-plus-circle"></i> <span id="rrhh-role-form-title">Nuevo Rol</span></h3>
                        <div class="rrhh-form-grid">
                            <div class="rrhh-field">
                                <label>Nombre del Rol</label>
                                <input type="text" id="rrhh-role-name" placeholder="Ej: Cajero">
                            </div>
                            <div class="rrhh-field">
                                <label>Color</label>
                                <input type="color" id="rrhh-role-color" value="#7b2d8e">
                            </div>
                        </div>
                        <div class="rrhh-field">
                            <label>Permisos</label>
                            <div class="rrhh-permissions-grid" id="rrhh-role-permissions"></div>
                        </div>
                        <button class="rrhh-save-btn" id="rrhh-role-save-btn"><i class="fas fa-save"></i> Guardar Rol</button>
                    </div>
                    <div id="rrhh-roles-list" class="rrhh-roles-grid"></div>
                </div>

                <!-- TAB: Colaboradores -->
                <div id="rrhh-tab-colaboradores" class="rrhh-tab-content hidden">
                    <div class="rrhh-card-form">
                        <h3><i class="fas fa-user-plus"></i> <span id="rrhh-collab-form-title">Nuevo Colaborador</span></h3>
                        <div class="rrhh-form-grid">
                            <div class="rrhh-field">
                                <label>Nombre Completo</label>
                                <input type="text" id="rrhh-collab-name" placeholder="Nombre y Apellido">
                            </div>
                            <div class="rrhh-field">
                                <label>CÃ©dula</label>
                                <input type="text" id="rrhh-collab-cedula" placeholder="8-888-8888">
                            </div>
                            <div class="rrhh-field">
                                <label>TelÃ©fono</label>
                                <input type="tel" id="rrhh-collab-phone" placeholder="+507 6000-0000">
                            </div>
                            <div class="rrhh-field">
                                <label>Rol</label>
                                <select id="rrhh-collab-role"><option value="">Seleccionar rol...</option></select>
                            </div>
                        </div>
                        <button class="rrhh-save-btn" id="rrhh-collab-save-btn"><i class="fas fa-save"></i> Guardar Colaborador</button>
                    </div>
                    <div id="rrhh-pendientes-section" class="rrhh-pendientes hidden">
                        <h3 class="rrhh-pendientes-title"><i class="fas fa-exclamation-triangle"></i> Pendientes de BiometrÃ­a</h3>
                        <div id="rrhh-pendientes-list" class="rrhh-collab-grid"></div>
                    </div>
                    <h3 class="rrhh-sub-title"><i class="fas fa-users"></i> Colaboradores Activos</h3>
                    <div id="rrhh-collabs-list" class="rrhh-collab-grid"></div>
                </div>

                <!-- TAB: Reportes -->
                <div id="rrhh-tab-reportes" class="rrhh-tab-content hidden">
                    <div class="rrhh-report-controls">
                        <div class="rrhh-report-range">
                            <button class="rrhh-range-btn active" data-rrhh-range="today">Hoy</button>
                            <button class="rrhh-range-btn" data-rrhh-range="week">Semana</button>
                            <button class="rrhh-range-btn" data-rrhh-range="month">Mes</button>
                            <button class="rrhh-range-btn" data-rrhh-range="custom">Rango</button>
                        </div>
                        <div class="rrhh-report-custom hidden" id="rrhh-report-custom">
                            <input type="date" id="rrhh-report-from">
                            <span>â€”</span>
                            <input type="date" id="rrhh-report-to">
                            <button class="rrhh-apply-btn" id="rrhh-report-apply"><i class="fas fa-search"></i></button>
                        </div>
                    </div>
                    <div class="rrhh-stats-grid" id="rrhh-stats-grid"></div>
                    <div class="rrhh-report-table-wrap">
                        <h3><i class="fas fa-table"></i> Historial Completo</h3>
                        <table class="rrhh-table" id="rrhh-report-table">
                            <thead><tr><th>Fecha/Hora</th><th>Colaborador</th><th>Rol</th><th>Tipo</th><th>Foto</th></tr></thead>
                            <tbody id="rrhh-report-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- COMPORTAMIENTO Section -->
            <section id="admin-sec-comportamiento" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-brain"></i> Comportamiento del Cliente</h2>
                    <p class="admin-section-subtitle">AnalÃ­ticas de trÃ¡fico, horarios y patrones de compra</p>
                </div>
                <div class="beh-date-controls">
                    <button class="beh-range-btn active" data-beh-range="week">Semana</button>
                    <button class="beh-range-btn" data-beh-range="month">Mes</button>
                    <button class="beh-range-btn" data-beh-range="quarter">Trimestre</button>
                </div>
                <div class="beh-kpi-grid" id="beh-kpi-grid"></div>
                <div class="beh-panel beh-panel-full" id="beh-heatmap-panel">
                    <h3><i class="fas fa-fire"></i> Mapa de Calor â€” Horarios de Venta</h3>
                    <p class="beh-panel-sub">Intensidad de transacciones por dÃ­a y hora</p>
                    <div class="beh-heatmap" id="beh-heatmap"></div>
                    <div class="beh-heatmap-legend">
                        <span>Menor</span>
                        <div class="beh-legend-gradient"></div>
                        <span>Mayor</span>
                    </div>
                </div>
                <div class="beh-grid-2col">
                    <div class="beh-panel" id="beh-products-by-time">
                        <h3><i class="fas fa-clock"></i> Productos por Horario</h3>
                    </div>
                    <div class="beh-panel" id="beh-payment-trends">
                        <h3><i class="fas fa-credit-card"></i> Tendencia de Pagos</h3>
                    </div>
                </div>
                <div class="beh-grid-2col">
                    <div class="beh-panel" id="beh-devices">
                        <h3><i class="fas fa-mobile-alt"></i> TrÃ¡fico por Dispositivo</h3>
                    </div>
                    <div class="beh-panel" id="beh-customer-patterns">
                        <h3><i class="fas fa-users"></i> Patrones de Clientes</h3>
                    </div>
                </div>
            </section>

            <!-- FACTURACION Section -->
            <section id="admin-sec-facturacion" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-file-invoice-dollar"></i> FacturaciÃ³n</h2>
                </div>
                <div class="fact-controls">
                    <div class="fact-filters">
                        <div class="fact-date-range">
                            <label>Desde</label>
                            <input type="date" id="fact-date-from">
                            <label>Hasta</label>
                            <input type="date" id="fact-date-to">
                            <button class="fact-filter-btn" id="fact-filter-btn"><i class="fas fa-search"></i> Filtrar</button>
                        </div>
                        <div class="fact-quick-filters">
                            <button class="fact-quick-btn active" data-range="today">Hoy</button>
                            <button class="fact-quick-btn" data-range="week">Esta Semana</button>
                            <button class="fact-quick-btn" data-range="month">Este Mes</button>
                            <button class="fact-quick-btn" data-range="all">Todos</button>
                        </div>
                    </div>
                    <div class="fact-summary">
                        <div class="fact-stat">
                            <span class="fact-stat-label">Facturas</span>
                            <span class="fact-stat-value" id="fact-count">0</span>
                        </div>
                        <div class="fact-stat">
                            <span class="fact-stat-label">Ventas Totales</span>
                            <span class="fact-stat-value fact-stat-accent" id="fact-total-sales">$0.00</span>
                        </div>
                        <div class="fact-stat">
                            <span class="fact-stat-label">Promedio</span>
                            <span class="fact-stat-value" id="fact-avg">$0.00</span>
                        </div>
                    </div>
                </div>
                <div class="fact-list" id="fact-list">
                    <p class="no-orders">Cargando facturas...</p>
                </div>
            </section>

            <!-- Invoice Detail Modal -->
            <div class="fact-modal hidden" id="fact-modal">
                <div class="fact-modal-content">
                    <div class="fact-modal-header">
                        <h3><i class="fas fa-file-invoice"></i> <span id="fact-modal-title">Factura</span></h3>
                        <button class="fact-modal-close" id="fact-modal-close"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="fact-modal-body" id="fact-modal-body"></div>
                    <div class="fact-modal-actions">
                        <button class="fact-print-btn" id="fact-print-btn"><i class="fas fa-print"></i> Imprimir</button>
                        <button class="fact-void-btn" id="fact-void-btn"><i class="fas fa-ban"></i> Anular Factura</button>
                    </div>
                </div>
            </div>

            <!-- Void Invoice Modal -->
            <div class="fact-modal hidden" id="fact-void-modal">
                <div class="fact-modal-content" style="max-width:420px">
                    <div class="fact-modal-header">
                        <h3><i class="fas fa-ban"></i> Anular Factura</h3>
                        <button class="fact-modal-close" id="fact-void-modal-close"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="fact-modal-body" style="padding:16px">
                        <p style="margin-bottom:12px;color:var(--text-light);font-size:13px">Esta factura quedarÃ¡ marcada como <strong>ANULADA</strong>. El registro no se eliminarÃ¡.</p>
                        <label style="font-size:12px;font-weight:600;margin-bottom:4px;display:block">RazÃ³n de anulaciÃ³n <span style="color:#e74c3c">*</span></label>
                        <textarea id="fact-void-reason" rows="3" placeholder="Escribe la razÃ³n de la anulaciÃ³n..." style="width:100%;padding:10px;border:1px solid var(--border);border-radius:8px;font-size:13px;resize:vertical;font-family:inherit"></textarea>
                        <p id="fact-void-error" style="color:#e74c3c;font-size:11px;margin-top:4px;display:none">Debes escribir una razÃ³n para anular.</p>
                    </div>
                    <div class="fact-modal-actions">
                        <button class="fact-print-btn" id="fact-void-cancel-btn" style="background:var(--bg-card);color:var(--text)">Cancelar</button>
                        <button class="fact-void-btn" id="fact-void-confirm-btn"><i class="fas fa-ban"></i> Confirmar AnulaciÃ³n</button>
                    </div>
                </div>
            </div>

            <!-- ASISTENCIA Standalone Section -->
            <section id="admin-sec-asistencia" class="admin-section hidden">
                <div class="att-standalone-container">
                    <div class="att-clock-display">
                        <div class="att-clock-time" id="att-clock-time">00:00:00</div>
                        <div class="att-clock-date" id="att-clock-date">--</div>
                    </div>
                    <div class="att-type-selection">
                        <h2><i class="fas fa-fingerprint"></i> Registrar Asistencia</h2>
                        <p class="att-instruction">Selecciona el tipo de registro y escanea tu rostro</p>
                        <div class="att-type-btns">
                            <button class="att-type-btn active" data-att-type="entrada"><i class="fas fa-sign-in-alt"></i> Entrada</button>
                            <button class="att-type-btn" data-att-type="salida"><i class="fas fa-sign-out-alt"></i> Salida</button>
                        </div>
                        <button class="att-start-scan-btn" id="att-start-scan-btn"><i class="fas fa-camera"></i> Iniciar Escaneo Facial</button>
                    </div>
                </div>
            </section>

            <!-- MESAS / TABLE MANAGEMENT Section -->
            <section id="admin-sec-mesas" class="admin-section hidden">
                <div class="admin-section-header">
                    <h2><i class="fas fa-chair"></i> AtenciÃ³n de Mesas</h2>
                    <p class="admin-section-subtitle">Asigna comensales, toma pedidos y gestiona cuentas por separado</p>
                </div>

                <!-- Vista Mapa de Mesas -->
                <div class="mesas-map-view" id="mesas-map-view">
                    <div class="mesas-legend">
                        <span class="mesa-legend-item libre"><i class="fas fa-circle"></i> Libre</span>
                        <span class="mesa-legend-item ocupada"><i class="fas fa-circle"></i> Ocupada</span>
                        <span class="mesa-legend-item cuenta_pedida"><i class="fas fa-circle"></i> Cuenta pedida</span>
                    </div>
                    <div class="mesas-grid" id="mesas-grid">
                        <!-- Cards renderizadas por JS -->
                    </div>
                    <div class="mesas-actions-bar">
                        <button class="mesas-add-btn" id="mesas-add-table"><i class="fas fa-plus"></i> Agregar Mesa</button>
                    </div>
                </div>

                <!-- Vista Detalle de Mesa (oculta por defecto) -->
                <div class="mesa-detail hidden" id="mesa-detail">
                    <div class="mesa-detail-header">
                        <button class="mesa-back-btn" id="mesa-back-btn"><i class="fas fa-arrow-left"></i> Volver</button>
                        <h3 id="mesa-detail-title">Mesa 1</h3>
                        <span class="mesa-detail-status badge-libre" id="mesa-detail-status">Libre</span>
                        <div class="mesa-diner-count-ctrl" id="mesa-diner-count-ctrl">
                            <span>Comensales:</span>
                            <button class="mesa-count-btn" id="mesa-diner-minus"><i class="fas fa-minus"></i></button>
                            <span id="mesa-diner-count-display">4</span>
                            <button class="mesa-count-btn" id="mesa-diner-plus"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>

                    <!-- Tabs de comensales -->
                    <div class="mesa-diners" id="mesa-diners"></div>

                    <!-- Layout de pedido: productos | cuenta del comensal -->
                    <div class="mesa-order-layout" id="mesa-order-layout">
                        <div class="mesa-products-panel">
                            <div class="pos-categories" id="mesa-categories"></div>
                            <div class="pos-products-grid" id="mesa-products-grid"></div>
                        </div>
                        <div class="mesa-diner-panel">
                            <div class="mesa-diner-name-edit">
                                <i class="fas fa-user"></i>
                                <input type="text" id="mesa-diner-name-input" placeholder="Nombre del comensal">
                                <button class="mesa-save-name-btn" id="mesa-save-name-btn"><i class="fas fa-check"></i></button>
                            </div>
                            <div class="mesa-diner-items" id="mesa-diner-items">
                                <p class="pos-empty">Selecciona productos para este comensal</p>
                            </div>
                            <div class="mesa-diner-totals">
                                <div class="pos-total-line"><span>Subtotal comensal:</span><span id="mesa-diner-subtotal">$0.00</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Resumen de cuenta de toda la mesa -->
                    <div class="mesa-bill-section hidden" id="mesa-bill-section">
                        <h4><i class="fas fa-file-invoice-dollar"></i> Cuenta de la Mesa</h4>
                        <div id="mesa-bill-diners"></div>
                        <div class="mesa-bill-total-row">
                            <span>Total Mesa</span>
                            <span id="mesa-bill-total">$0.00</span>
                        </div>
                        <div class="mesa-bill-actions">
                            <button class="mesa-bill-btn" id="mesa-bill-pay-all"><i class="fas fa-users"></i> Cobrar Todo Junto</button>
                        </div>
                    </div>

                    <!-- Botones de acciÃ³n de mesa -->
                    <div class="mesa-action-bar">
                        <button class="mesa-action-btn mesa-btn-open hidden" id="mesa-open-btn"><i class="fas fa-door-open"></i> Abrir Mesa</button>
                        <button class="mesa-action-btn mesa-btn-bill hidden" id="mesa-request-bill-btn"><i class="fas fa-file-invoice"></i> Pedir Cuenta</button>
                        <button class="mesa-action-btn mesa-btn-close hidden" id="mesa-close-btn"><i class="fas fa-check-circle"></i> Cerrar Mesa</button>
                    </div>
                </div>
            </section>

            <!-- USUARIOS Section -->
            <section id="admin-sec-usuarios" class="admin-section hidden">
                <!-- Vista Lista -->
                <div id="usr-list-view">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-users"></i> Usuarios</h2>
                        <p class="admin-section-subtitle">Clientes que han realizado transacciones</p>
                    </div>

                    <div class="usr-search-wrap">
                        <i class="fas fa-search"></i>
                        <input type="text" id="usr-search" placeholder="Buscar por nombre o telÃ©fono..." maxlength="60">
                    </div>

                    <div class="usr-stats-row" id="usr-stats-row">
                        <div class="usr-stat-card">
                            <span class="usr-stat-value" id="usr-stat-total">0</span>
                            <span class="usr-stat-label">Total Clientes</span>
                        </div>
                        <div class="usr-stat-card">
                            <span class="usr-stat-value" id="usr-stat-active">0</span>
                            <span class="usr-stat-label">Activos (30d)</span>
                        </div>
                        <div class="usr-stat-card">
                            <span class="usr-stat-value" id="usr-stat-revenue">$0</span>
                            <span class="usr-stat-label">Ingresos Totales</span>
                        </div>
                    </div>

                    <div class="usr-sort-bar">
                        <button class="usr-sort-btn active" data-sort="recent"><i class="fas fa-clock"></i> Recientes</button>
                        <button class="usr-sort-btn" data-sort="spent"><i class="fas fa-dollar-sign"></i> Mayor Gasto</button>
                        <button class="usr-sort-btn" data-sort="orders"><i class="fas fa-shopping-bag"></i> MÃ¡s Pedidos</button>
                    </div>

                    <div class="usr-grid" id="usr-list-container">
                        <div class="usr-empty">
                            <i class="fas fa-user-friends"></i>
                            <p>No hay clientes registrados aÃºn</p>
                        </div>
                    </div>
                </div>

                <!-- Vista Detalle -->
                <div id="usr-detail-view" class="hidden">
                    <button class="usr-back-btn" id="usr-back-btn">
                        <i class="fas fa-arrow-left"></i> Volver
                    </button>

                    <div class="usr-profile" id="usr-profile">
                        <!-- Filled by JS -->
                    </div>

                    <div class="usr-detail-stats" id="usr-detail-stats">
                        <!-- Filled by JS -->
                    </div>

                    <div class="usr-history-header">
                        <h3><i class="fas fa-history"></i> Historial de Transacciones</h3>
                    </div>
                    <div class="usr-timeline" id="usr-timeline">
                        <p class="usr-loading"><i class="fas fa-spinner fa-spin"></i> Cargando historial...</p>
                    </div>
                </div>
            </section>

        </main>

        <!-- Attendance Auto-Scan Overlay (direct child of admin-dashboard, outside <main> to avoid overflow:auto clipping) -->
        <div class="att-scan-overlay hidden" id="att-scan-overlay">
            <div class="att-scan-container">
                <button class="att-scan-close" id="att-scan-close"><i class="fas fa-times"></i></button>
                <div class="att-scan-viewport">
                    <video id="att-scan-video" autoplay playsinline></video>
                    <canvas id="att-scan-canvas" style="display:none"></canvas>
                    <div class="att-face-guide"><div class="att-face-corners"></div></div>
                    <div class="att-scan-line hidden" id="att-scan-line"></div>
                    <div class="att-scan-pulse hidden" id="att-scan-pulse"></div>
                    <div class="att-scan-status" id="att-scan-status">
                        <span id="att-scan-status-text">Posiciona tu rostro en el centro</span>
                    </div>
                    <div class="att-scan-result hidden" id="att-scan-result">
                        <i class="fas fa-check-circle" id="att-scan-result-icon"></i>
                        <span id="att-scan-result-text">Identificado</span>
                    </div>
                </div>
                <div class="att-scan-info">
                    <div class="att-scan-clock" id="att-scan-clock">--:--:--</div>
                    <div class="att-scan-type entrada" id="att-scan-type"><i class="fas fa-sign-in-alt"></i> Entrada</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ORDER CONFIRMATION -->
    <div class="confirmation-overlay hidden" id="confirmation-overlay">
        <div class="confirmation-modal">
            <div class="confirmation-icon"><i class="fas fa-check-circle"></i></div>
            <h2>Â¡Pedido Realizado!</h2>
            <p>Tu pedido <strong id="order-number"></strong> ha sido recibido</p>
            <p class="confirmation-detail">Te notificaremos cuando estÃ© listo</p>
            <button class="btn-confirm-ok" id="btn-confirm-ok">Aceptar</button>
        </div>
    </div>

    <!-- RATING MODAL -->
    <div class="rating-overlay hidden" id="rating-overlay">
        <div class="rating-modal">
            <div class="rating-icon"><i class="fas fa-star"></i></div>
            <h2>Â¿CÃ³mo estuvo tu pedido?</h2>
            <p class="rating-order-ref" id="rating-order-ref"></p>
            <div class="rating-stars" id="rating-stars">
                <i class="fas fa-star" data-star="1"></i>
                <i class="fas fa-star" data-star="2"></i>
                <i class="fas fa-star" data-star="3"></i>
                <i class="fas fa-star" data-star="4"></i>
                <i class="fas fa-star" data-star="5"></i>
            </div>
            <textarea id="rating-comment" placeholder="CuÃ©ntanos tu experiencia (opcional)" maxlength="200"></textarea>
            <button class="btn-rating-submit" id="btn-rating-submit" disabled>Enviar CalificaciÃ³n</button>
            <button class="btn-rating-skip" id="btn-rating-skip">Ahora no</button>
        </div>
    </div>

    <!-- PAYMENT MODAL (Yappy) -->
    <div class="modal-overlay hidden" id="payment-modal">
        <div class="payment-modal-content">
            <button class="modal-close" id="payment-modal-close"><i class="fas fa-times"></i></button>

            <div class="payment-header">
                <div class="payment-logo">
                    <img src="images/logo-xazai.png" alt="XAZAI" class="logo-img-payment">
                </div>
                <h2>Resumen de Pedido</h2>
            </div>

            <div class="payment-summary">
                <div class="payment-order-detail" id="payment-order-detail">
                    <!-- Cart items injected by JS -->
                </div>
                <div class="payment-line payment-line-subtotal">
                    <span>Subtotal</span>
                    <span id="payment-subtotal">$0.00</span>
                </div>
                <div class="payment-line payment-line-delivery">
                    <span><i class="fas fa-motorcycle"></i> EnvÃ­o <small class="delivery-fee-info hidden" id="delivery-fee-info"></small></span>
                    <span id="payment-delivery">Selecciona ubicaciÃ³n</span>
                </div>
                <div class="payment-line payment-line-tip">
                    <span><i class="fas fa-heart"></i> Propina</span>
                    <span id="payment-tip-amount">$0.00</span>
                </div>
                <div class="payment-line payment-line-total">
                    <span>Total a pagar</span>
                    <span id="payment-total">$0.00</span>
                </div>
            </div>

            <div class="tip-section">
                <h4><i class="fas fa-heart"></i> Â¿Deseas dejar propina?</h4>
                <div class="tip-type-row">
                    <button class="tip-type-btn active" data-tip-type="percent"><i class="fas fa-percent"></i> Porcentaje</button>
                    <button class="tip-type-btn" data-tip-type="fixed"><i class="fas fa-dollar-sign"></i> Monto Fijo</button>
                </div>
                <div class="tip-options tip-options-percent" id="tip-options-percent">
                    <button class="tip-btn" data-tip-pct="10">10%</button>
                    <button class="tip-btn" data-tip-pct="15">15%</button>
                    <button class="tip-btn" data-tip-pct="18">18%</button>
                    <button class="tip-btn" data-tip-pct="20">20%</button>
                </div>
                <div class="tip-options tip-options-fixed hidden" id="tip-options-fixed">
                    <button class="tip-btn" data-tip="1">$1</button>
                    <button class="tip-btn" data-tip="2">$2</button>
                    <button class="tip-btn" data-tip="5">$5</button>
                </div>
                <div class="tip-options">
                    <button class="tip-btn tip-btn-custom" data-tip="custom"><i class="fas fa-edit"></i> Otra cantidad</button>
                </div>
                <div class="tip-custom-input hidden" id="tip-custom-input">
                    <span class="tip-currency">$</span>
                    <input type="number" id="tip-custom-value" placeholder="0.00" min="0" max="100" step="0.50">
                    <button class="tip-custom-apply" id="tip-custom-apply">OK</button>
                </div>
            </div>

            <div class="scheduled-banner hidden" id="scheduled-banner">
                <i class="fas fa-clock"></i>
                <span id="scheduled-banner-text">Pedido agendado</span>
            </div>

            <div class="payment-address">
                <h4><i class="fas fa-map-marker-alt"></i> DirecciÃ³n de entrega</h4>
                <div class="map-container" id="map-container"></div>
                <textarea class="address-input" id="delivery-address" placeholder="Detalles adicionales: edificio, apto, referencias..." rows="2" maxlength="300"></textarea>
            </div>

            <div class="payment-methods">
                <h3>Selecciona tu mÃ©todo de pago</h3>

                <div id="yappy-btn-container">
                    <btn-yappy theme="blue" rounded="true"></btn-yappy>
                </div>

                <div class="yappy-loading hidden" id="yappy-loading">
                    <div class="spinner"></div>
                    <span>Procesando pago con Yappy...</span>
                </div>

                <div class="yappy-error hidden" id="yappy-error">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="yappy-error-msg">Error al conectar</span>
                </div>

                <div class="payment-divider">
                    <span>o</span>
                </div>

                <button class="btn-pay-cash" id="btn-pay-cash">
                    <div class="pay-btn-content">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Pagar en el local</span>
                    </div>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>

            <p class="payment-secure"><i class="fas fa-shield-alt"></i> Pago seguro con encriptaciÃ³n SSL</p>
        </div>
    </div>

    <!-- SCHEDULE ORDER MODAL (when store is closed) -->
    <div class="modal-overlay hidden" id="schedule-modal">
        <div class="schedule-modal-content">
            <button class="modal-close" id="schedule-modal-close"><i class="fas fa-times"></i></button>
            <div class="schedule-icon"><i class="fas fa-clock"></i></div>
            <h2>Estamos cerrados ahora</h2>
            <p class="schedule-subtitle" id="schedule-subtitle">Pero puedes agendar tu pedido para cuando abramos</p>
            <div class="schedule-options" id="schedule-options">
                <!-- Time slots injected by JS -->
            </div>
            <button class="btn-schedule-confirm" id="btn-schedule-confirm" disabled>
                <i class="fas fa-calendar-check"></i> Confirmar Horario y Continuar
            </button>
            <button class="btn-schedule-cancel" id="btn-schedule-cancel">Cancelar</button>
        </div>
    </div>

    <!-- ADMIN SECRET LOGIN MODAL -->
    <div class="modal-overlay hidden" id="admin-login-modal">
        <div class="login-modal-content admin-secret-login">
            <button class="modal-close" id="admin-login-close"><i class="fas fa-times"></i></button>
            <div class="login-logo">
                <i class="fas fa-shield-alt" style="font-size: 40px; color: var(--accent);"></i>
            </div>
            <h2>Acceso Administrador</h2>
            <p class="login-subtitle">Ingresa tu correo de administrador</p>
            <form id="admin-login-form">
                <div class="phone-number-wrapper" style="width:100%;">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="admin-login-email" placeholder="correo@xazai.com" autocomplete="off">
                </div>
                <button type="submit" class="btn-login"><i class="fas fa-lock"></i> Ingresar como Admin</button>
            </form>
            <p id="admin-login-error" class="login-error"></p>
        </div>
    </div>

    <!-- RRHH Biometric Camera Modal -->
    <div class="modal-overlay hidden" id="rrhh-camera-modal">
        <div class="rrhh-camera-content">
            <button class="modal-close" id="rrhh-camera-close"><i class="fas fa-times"></i></button>
            <h2 id="rrhh-camera-title">Registro BiomÃ©trico</h2>
            <p class="rrhh-camera-subtitle" id="rrhh-camera-subtitle">Posiciona tu rostro en el centro</p>
            <div class="rrhh-camera-viewport">
                <video id="rrhh-camera-video" autoplay playsinline></video>
                <canvas id="rrhh-camera-canvas" style="display:none"></canvas>
                <div class="rrhh-face-guide"></div>
                <div class="rrhh-countdown hidden" id="rrhh-countdown"><span id="rrhh-countdown-number">3</span></div>
                <div class="rrhh-scan-line hidden" id="rrhh-scan-line"></div>
                <div class="rrhh-scan-result hidden" id="rrhh-scan-result">
                    <i class="fas fa-check-circle"></i>
                    <span id="rrhh-scan-result-text">Verificado</span>
                </div>
            </div>
            <div class="rrhh-camera-actions">
                <button class="rrhh-capture-btn" id="rrhh-capture-btn"><i class="fas fa-camera"></i> Capturar</button>
            </div>
        </div>
    </div>

    <!-- RRHH Attendance Confirmation Overlay -->
    <div class="rrhh-confirm-overlay hidden" id="rrhh-confirm-overlay">
        <div class="rrhh-confirm-modal">
            <div class="rrhh-confirm-check">
                <svg class="rrhh-checkmark" viewBox="0 0 52 52">
                    <circle class="rrhh-checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                    <path class="rrhh-checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                </svg>
            </div>
            <h2 id="rrhh-confirm-name">â€”</h2>
            <div class="rrhh-confirm-role"><span class="rrhh-role-badge" id="rrhh-confirm-badge">â€”</span></div>
            <div class="rrhh-confirm-type" id="rrhh-confirm-type"><i class="fas fa-sign-in-alt"></i> Entrada</div>
            <div class="rrhh-confirm-time" id="rrhh-confirm-time">--:--:--</div>
            <div class="rrhh-confirm-date" id="rrhh-confirm-date">--</div>
            <button class="btn-confirm-ok" id="rrhh-confirm-ok">Aceptar</button>
        </div>
    </div>

    <!-- MESA PAYMENT MODAL -->
    <div class="modal-overlay hidden" id="mesa-pay-modal">
        <div class="mesa-pay-content">
            <button class="modal-close" id="mesa-pay-close"><i class="fas fa-times"></i></button>
            <h3><i class="fas fa-cash-register"></i> Cobrar <span id="mesa-pay-title"></span></h3>
            <div class="mesa-pay-summary" id="mesa-pay-summary"></div>

            <!-- Descuento -->
            <div class="mesa-pay-section">
                <span class="mesa-pay-section-label">Descuento</span>
                <div class="mesa-discount-options">
                    <button class="mesa-discount-btn active" data-discount="0">Sin</button>
                    <button class="mesa-discount-btn" data-discount="15">15% <small>Jubilado</small></button>
                    <button class="mesa-discount-btn" data-discount="10">10%</button>
                    <button class="mesa-discount-btn" data-discount="custom">Otro</button>
                </div>
                <div class="mesa-discount-custom hidden" id="mesa-discount-custom">
                    <div class="mesa-input-wrap"><span>%</span><input type="number" id="mesa-discount-amount" placeholder="0" min="0" max="100" step="1"></div>
                </div>
            </div>

            <!-- Propina -->
            <div class="mesa-pay-section">
                <span class="mesa-pay-section-label">Propina</span>
                <div class="mesa-tip-type-row">
                    <button class="mesa-tip-type-btn active" data-mesa-tip-type="fixed">$ Fijo</button>
                    <button class="mesa-tip-type-btn" data-mesa-tip-type="percent">% Pct</button>
                </div>
                <div class="mesa-tip-options" id="mesa-tip-opts-fixed">
                    <button class="mesa-tip-btn active" data-tip="0">Sin</button>
                    <button class="mesa-tip-btn" data-tip="1">$1</button>
                    <button class="mesa-tip-btn" data-tip="2">$2</button>
                    <button class="mesa-tip-btn" data-tip="5">$5</button>
                    <button class="mesa-tip-btn" data-tip="custom">Otro</button>
                </div>
                <div class="mesa-tip-options hidden" id="mesa-tip-opts-percent">
                    <button class="mesa-tip-pct-btn" data-pct="10">10%</button>
                    <button class="mesa-tip-pct-btn" data-pct="15">15%</button>
                    <button class="mesa-tip-pct-btn" data-pct="18">18%</button>
                    <button class="mesa-tip-pct-btn" data-pct="20">20%</button>
                </div>
                <div class="mesa-tip-custom hidden" id="mesa-tip-custom">
                    <div class="mesa-input-wrap"><span>$</span><input type="number" id="mesa-tip-amount" placeholder="0.00" min="0" step="0.01"></div>
                </div>
            </div>

            <!-- Totales desglosados -->
            <div class="mesa-pay-totals">
                <div class="mesa-pay-line"><span>Subtotal</span><span id="mesa-pay-subtotal">$0.00</span></div>
                <div class="mesa-pay-line mesa-pay-discount-line hidden" id="mesa-pay-discount-line">
                    <span>Descuento (<span id="mesa-pay-discount-pct">0</span>%)</span>
                    <span id="mesa-pay-discount-value" class="mesa-discount-savings">-$0.00</span>
                </div>
                <div class="mesa-pay-line" id="mesa-pay-tip-line"><span>Propina</span><span id="mesa-pay-tip-display">$0.00</span></div>
                <div class="mesa-pay-line mesa-pay-line-total"><span>Total</span><strong id="mesa-pay-total">$0.00</strong></div>
            </div>

            <!-- Metodo de Pago -->
            <div class="mesa-pay-section">
                <h4 class="mesa-pay-section-title">MÃ©todo de Pago</h4>
                <div class="pos-methods">
                    <button class="mesa-method-btn active" data-method="efectivo"><i class="fas fa-money-bill-wave"></i> Efectivo</button>
                    <button class="mesa-method-btn" data-method="yappy"><i class="fas fa-mobile-alt"></i> Yappy</button>
                    <button class="mesa-method-btn" data-method="tarjeta"><i class="fas fa-credit-card"></i> Tarjeta</button>
                    <button class="mesa-method-btn" data-method="ach"><i class="fas fa-university"></i> ACH</button>
                </div>
                <!-- Efectivo: recibido y cambio -->
                <div class="mesa-cash-change" id="mesa-cash-change">
                    <div class="mesa-cash-row">
                        <label>Recibido:</label>
                        <div class="mesa-input-wrap"><span>$</span><input type="number" id="mesa-cash-received" placeholder="0.00" min="0" step="0.01"></div>
                    </div>
                    <div class="mesa-cash-row mesa-change-row">
                        <label>Cambio:</label>
                        <span id="mesa-change-amount" class="mesa-change-value">$0.00</span>
                    </div>
                </div>
                <!-- Refs por metodo -->
                <div class="mesa-payment-details hidden" id="mesa-payment-details-tarjeta">
                    <div class="mesa-cash-row"><label><i class="fas fa-credit-card"></i> Ãšltimos 4 / Ref:</label><input type="text" id="mesa-tarjeta-ref" placeholder="1234 o referencia" maxlength="30" class="mesa-ref-input"></div>
                </div>
                <div class="mesa-payment-details hidden" id="mesa-payment-details-ach">
                    <div class="mesa-cash-row"><label><i class="fas fa-university"></i> Ref ACH:</label><input type="text" id="mesa-ach-ref" placeholder="Referencia de transferencia" maxlength="40" class="mesa-ref-input"></div>
                </div>
                <div class="mesa-payment-details hidden" id="mesa-payment-details-yappy">
                    <div class="mesa-cash-row"><label><i class="fas fa-mobile-alt"></i> Ref Yappy:</label><input type="text" id="mesa-yappy-ref" placeholder="Ref. de transacciÃ³n Yappy" maxlength="40" class="mesa-ref-input"></div>
                </div>
            </div>

            <button class="pos-charge-btn" id="mesa-confirm-pay" style="margin:0;width:100%;"><i class="fas fa-check-circle"></i> Confirmar Pago</button>
        </div>
    </div>

    <!-- TOAST NOTIFICATIONS -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
    <script src="data.js?v=20260222e"></script>
    <script type="module" src="https://bt-cdn.yappy.cloud/v1/cdn/web-component-btn-yappy.js"></script>
    <script src="app.js?v=20260224b"></script>
</body>
</html>
